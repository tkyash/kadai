<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.kadai.domain.repository.user.UserRepository">

    <resultMap id="UserResultMap" type="User">
        <id property="id" column="userid" />
        <result property="name" column="username" />
        <result property="birthday" column="birthday" />
        <result property="address" column="address" />
        <result property="tel" column="tel" />
        <result property="password" column="password" />
        <result property="userRole" column="role" />
        <result property="userStatus" column="status" />
        <result property="updatedate" column="updatedate" />
    </resultMap>

    <select id="findOne" parameterType="string" resultMap="UserResultMap">
    <![CDATA[
        SELECT
            userid,
            username, 
            birthday, 
            address, 
            tel,
            password,
            status,
            updatedate
        FROM
            t_user 
        WHERE
            userid = #{id}
    ]]>
    </select>

    <select id="findAll" resultMap="UserResultMap">
    <![CDATA[
        SELECT
            username, 
            birthday, 
            address, 
            tel,
            password,
            status,
            updatedate
        FROM
            t_user 
    ]]>
    </select>

    <insert id="create" parameterType="User">
    <![CDATA[
        INSERT INTO t_user
        (
            userid,
            username, 
            birthday, 
            address, 
            tel,
            password,
            status,
            updatedate
        ) 
        VALUES
        (
            #{id}, 
            #{name}, 
            #{birthday},
            #{address},
            #{tel},
            #{password}, 
            #{userStatus},
            CURRENT_TIMESTAMP
        )
    ]]>
    </insert>

    <update id="update" parameterType="User">
    <![CDATA[
        UPDATE
            t_user 
        SET
            username = #{name}, 
            birthday = #{birthday}, 
            address = #{address},
            tel = #{tel},
            password = #{password},
            status = #{userStatus},
            updatedate = CURRENT_TIMESTAMP
        WHERE
            userid = #{id}
    ]]>
    </update>

    <delete id="delete" parameterType="string">
    <![CDATA[
        DELETE FROM t_user 
        WHERE
            userid = #{id}
    ]]>
    </delete>

    <select id="findOneRole" parameterType="string" resultMap="UserResultMap">
    <![CDATA[
        SELECT
            userid,
            role
        FROM
            t_role 
        WHERE
            userid = #{id}
    ]]>
    </select>

   <insert id="createRole" parameterType="Role">
    <![CDATA[
        INSERT INTO t_role
        (
            userid,
            role
        ) 
        VALUES
        (
            #{id}, 
            #{role}
        )
    ]]>
    </insert>


    <update id="updateRole" parameterType="Role">
    <![CDATA[
        UPDATE
            t_role 
        SET
            role = #{role}
        WHERE
            userid = #{id}
    ]]>
    </update>

    <delete id="deleteRole" parameterType="string">
    <![CDATA[
        DELETE FROM t_role 
        WHERE
            userid = #{id}
    ]]>
    </delete>

<!--

    <select id="countByFinished" parameterType="boolean" resultType="long">
    <![CDATA[
        SELECT
            COUNT(*)
        FROM
            todo 
        WHERE
            finished = #{finished}
    ]]>
    </select>

    <select id="exists" parameterType="string" resultType="long">
    <![CDATA[
        SELECT
            COUNT(*)
        FROM
            todo 
        WHERE
            todo_id = #{todoId}
    ]]>
    </select>




    <resultMap id="todoResultMap" type="Todo">
        <id property="todoId" column="todo_id" />
        <result property="todoTitle" column="todo_title" />
        <result property="finished" column="finished" />
        <result property="createdAt" column="created_at" />
    </resultMap>

    <select id="findOne" parameterType="string" resultMap="todoResultMap">
    <![CDATA[
        SELECT
            todo_id, 
            todo_title, 
            finished, 
            created_at 
        FROM
            todo 
        WHERE
            todo_id = #{todoId}
    ]]>
    </select>

    <select id="findAll" resultMap="todoResultMap">
    <![CDATA[
        SELECT
            todo_id, 
            todo_title, 
            finished, 
            created_at 
        FROM
            todo 
    ]]>
    </select>

    <insert id="create" parameterType="Todo">
    <![CDATA[
        INSERT INTO todo
        (
            todo_id, 
            todo_title, 
            finished, 
            created_at
        ) 
        VALUES
        (
            #{todoId}, 
            #{todoTitle}, 
            #{finished}, 
            #{createdAt}
        )
    ]]>
    </insert>

    <update id="update" parameterType="Todo">
    <![CDATA[
        UPDATE
            todo 
        SET
            todo_title = #{todoTitle}, 
            finished = #{finished}, 
            created_at = #{createdAt} 
        WHERE
            todo_id = #{todoId}
    ]]>
    </update>

    <delete id="delete" parameterType="Todo">
    <![CDATA[
        DELETE FROM todo 
        WHERE
            todo_id = #{todoId}
    ]]>
    </delete>

    <select id="countByFinished" parameterType="boolean" resultType="long">
    <![CDATA[
        SELECT
            COUNT(*)
        FROM
            todo 
        WHERE
            finished = #{finished}
    ]]>
    </select>

    <select id="exists" parameterType="string" resultType="long">
    <![CDATA[
        SELECT
            COUNT(*)
        FROM
            todo 
        WHERE
            todo_id = #{todoId}
    ]]>
    </select>

-->

</mapper>
